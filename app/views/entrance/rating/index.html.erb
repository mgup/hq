<script>
  $(function() {
    $('#page_sidebar').next().removeClass('col-sm-9').addClass('col-sm-12');
    $('#page_sidebar').hide();
    $('#return_up').hide();
  });
</script>

<div class="page-header">
  <h1>Конкурсные списки и приказы о зачислении</h1>
</div>

<%= render 'switch' %>

<% if @out_of_competition.any? %>
  <h2>Без вступительных испытаний</h2>
  <table class="table table-striped table-bordered">
    <thead>
      <tr>
        <th></th>
        <th>Рег. номер</th>
        <th>Поступающий</th>
        <th>Основание</th>
        <th>Оригинал</th>
      </tr>
    </thead>
    <tbody>
      <% @out_of_competition.sort_by { |a| [a.original? ? 0 : 1, a.number] }.each_with_index do |a, i| %>
        <tr>
          <td><%= i + 1 %></td>
          <%= render partial: 'out_of_competition', locals: { a: a } %>
        </tr>
      <% end %>
    </tbody>
  </table>
<% end %>

<% if @crimea.any? %>
  <h2>Выделенные места (Крым)</h2>
  <table class="table table-striped table-bordered">
    <thead>
    <tr>
      <th></th>
      <th>Рег. номер</th>
      <th>Поступающий</th>
      <% @exam_names_crimea.each do |_, name| %>
        <th><%= name.html_safe %></th>
      <% end %>
      <th>Сумма баллов</th>
      <th>Оригинал</th>
    </tr>
    </thead>
    <tbody>
    <% @crimea.sort_by(&Entrance::Application.sort_applications_for_sort_by).reverse.
         each_with_index do |a, i| %>
      <tr>
        <td><%= i + 1 %></td>
        <%= render partial: 'contest', locals: { a: a } %>
      </tr>
    <% end %>
    </tbody>
  </table>
<% end %>

<% if @special_rights.any? %>
  <h2>По квоте приема лиц, имеющих особое право</h2>
  <table class="table table-striped table-bordered">
    <thead>
    <tr>
      <th></th>
      <th>Рег. номер</th>
      <th>Поступающий</th>
      <% @exam_names.each do |_, name| %>
        <th><%= name.html_safe %></th>
      <% end %>
      <th>Сумма баллов</th>
      <th>Оригинал</th>
    </tr>
    </thead>
    <tbody>
    <% @special_rights.sort_by(&Entrance::Application.sort_applications_for_sort_by).reverse.
         each_with_index do |a, i| %>
      <tr>
        <td><%= i + 1 %></td>
        <%= render partial: 'contest', locals: { a: a } %>
      </tr>
    <% end %>
    </tbody>
  </table>
<% end %>

<% if @organization.any? %>
  <h2>По квоте целевого приема</h2>

  <% @organization.group_by { |a| a.competitive_group_target_item }.each do |target_item, appls| %>
    <h3>
      Договор № <%= target_item.target_organization.contract_number %>
      от <%= l(target_item.target_organization.contract_date) %>,
      <%= target_item.target_organization.name %>
    </h3>

    <table class="table table-striped table-bordered">
      <thead>
      <tr>
        <th></th>
        <th>Рег. номер</th>
        <th>Поступающий</th>
        <% @exam_names.each do |_, name| %>
          <th><%= name.html_safe %></th>
        <% end %>
        <th>Сумма баллов</th>
        <th>Оригинал</th>
      </tr>
      </thead>
      <tbody>
      <% appls.sort_by(&Entrance::Application.sort_applications_for_sort_by).reverse.
          each_with_index do |a, i| %>
        <tr>
          <td><%= i + 1 %></td>
          <%= render partial: 'contest', locals: { a: a } %>
        </tr>
      <% end %>
      </tbody>
    </table>
  <% end %>
<% end %>

<% if @contest.any? %>
  <h2>
    <% if @contest.first.payed? %>
      Конкурсные списки поступающих
    <% else %>
      Конкурсные списки поступающих на места в рамках контрольных цифр приема
    <% end %>
  </h2>
  <table class="table table-striped table-bordered">
    <thead>
    <tr>
      <th></th>
      <th>Рег. номер</th>
      <th>Поступающий</th>
      <% @exam_names.each do |_, name| %>
        <th><%= name.html_safe %></th>
      <% end %>
      <th>Сумма баллов</th>
      <th>Оригинал</th>
    </tr>
    </thead>
    <tbody>
    <% @contest.sort_by(&Entrance::Application.sort_applications_for_sort_by).reverse.
        each_with_index do |a, i| %>
      <tr>
        <td><%= i + 1 %></td>
        <%= render partial: 'contest', locals: { a: a } %>
      </tr>
    <% end %>
    </tbody>
  </table>
<% end %>
